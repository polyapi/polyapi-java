const Axios = require('axios');
const { HttpProxyAgent } = require('http-proxy-agent');
const { HttpsProxyAgent } = require('https-proxy-agent');
const https = require('https');
const dotenv = require('dotenv');

dotenv.config();

const httpProxy = process.env.HTTP_PROXY || process.env.http_proxy || process.env.npm_config_proxy;
const httpsProxy = process.env.HTTPS_PROXY || process.env.https_proxy || process.env.npm_config_https_proxy;
const nodeEnv = process.env.NODE_ENV;

const axios = Axios.create({
  baseURL: '{{apiBaseUrl}}',
 headers: { 'Authorization': 'Bearer {{apiKey}}' },
  httpAgent: httpProxy
    ? new HttpProxyAgent(httpProxy)
    : undefined,
  httpsAgent: httpsProxy
    ? new HttpsProxyAgent(httpsProxy, {
      rejectUnauthorized: nodeEnv !== 'development',
    })
    : nodeEnv === 'development'
      ? new https.Agent({ rejectUnauthorized: false })
      : undefined,
  proxy: false,
});

module.exports = axios;
